<!DOCTYPE html>
<html>
<head>
    <title>Данные из Google Таблиц</title>
    <style>
        /* Стили для таблицы */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-family: Arial, sans-serif;
        }

        .data-table th, .data-table td {
            padding: 12px;
            border: 1px solid #ddd;
            text-align: left;
        }

        .data-table th {
            background-color: #f8f9fa;
            font-weight: bold;
        }

        .data-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        .data-table tr:hover {
            background-color: #f1f1f1;
        }
    </style>
</head>
<body>
    <div id="data-container"></div>

    <script>
        // Настройки (замените на свои)
        const SHEET_ID = '1f2Ka0lWqId-KAZBggq3tDD-WHy_Ggu-0X8_CpZiB7IM'; // Из URL: docs.google.com/spreadsheets/d/[ЭТО_ID]/edit
        const SHEET_NAME = 'Ответы'; // Название листа

        // URL для запроса данных
        const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=${SHEET_NAME}`;

        // Загрузка данных
        fetch(url)
            .then(response => response.text())
            .then(data => {
                // Обработка JSON
                const parsedData = JSON.parse(data.substr(47).slice(0, -2));
                
                // Создание таблицы
                let table = document.createElement('table');
                table.classList.add('data-table');
                
                // Создание заголовка таблицы
                let thead = document.createElement('thead');
                let headerRow = document.createElement('tr');
                parsedData.table.cols.forEach(col => {
                    let th = document.createElement('th');
                    th.textContent = col.label; // Защищаем от XSS, используем textContent
                    headerRow.appendChild(th);
                });
                thead.appendChild(headerRow);
                table.appendChild(thead);

                // Создание тела таблицы
                let tbody = document.createElement('tbody');
                parsedData.table.rows.forEach(row => {
                    let tr = document.createElement('tr');
                    row.c.forEach(cell => {
                        let td = document.createElement('td');
                        td.textContent = cell?.v ?? ''; // Защищаем от XSS, используем textContent
                        tr.appendChild(td);
                    });
                    tbody.appendChild(tr);
                });
                table.appendChild(tbody);

                // Вставка таблицы в контейнер
                document.getElementById('data-container').appendChild(table);
            })
            .catch(error => {
                console.error('Ошибка:', error);
                document.getElementById('data-container').innerHTML = 
                    '<p style="color: red">Ошибка загрузки данных</p>';
            });
    </script>
